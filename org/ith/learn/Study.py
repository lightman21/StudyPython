import sysfrom org.ith.learn.TUtils import KCEBean, write_to_excel, open_excel_as_list# 所有字符串 key cn enall_string = "../../../docs/OnMobile-Android_app_all_strings.xlsx"all_trans = "../../../docs/all_trans_ed.xlsx"path_out_excel = "../../../docs/path_of_excelwrite.xlsx"def main(argv=None):    if argv is None:        argv = sys.argv    demo()def demo():    all_trans_list = remove_empty(open_excel_as_list(all_trans))    all_string_list = remove_empty(open_excel_as_list(all_string))    no_key_list = []    count = 0    key_list = []    for item in all_trans_list:        if has_key(item.cn, all_string_list):            count += 1            key_list.append(item)        else:            no_key_list.append(item)    write_to_excel(all_string_list, path_of_excel=path_out_excel)def remove_empty(mlist, need_replace=False):    tmp = []    for t in mlist:        if not need_replace and len(str(t.cn)) > 0 and len(str(t.en)) > 0:            tmp.append(t)        elif need_replace and len(str(t.cn)) > 0 and len(str(t.en)) > 0:            tcn = str(t.cn).replace("，", ",").replace("。", ".")            t.cn = tcn            tmp.append(t)        elif len(str(t.cn)) > 0:            tmp.append(t)    return tmpdef has_key(str_cn, all_trans_list):    for item in all_trans_list:        if item.cn == str_cn:            return item.keyif __name__ == "__main__":    sys.exit(main())